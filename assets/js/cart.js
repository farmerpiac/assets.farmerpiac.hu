let keys=[],products=null,cdn="https://cdn.farmerpiac.hu/",cdn2="https://cdn2.farmerpiac/";function keyCount(){for(var t=0;t<localStorage.length;t++)"ttl"!=localStorage.key(t)&&"cartValue"!=localStorage.key(t)&&keys.push(localStorage.key(t))}function cartGenerate(t,e){let a=0,r=JSON.stringify(t),l="";Object.keys(JSON.parse(r)).forEach((function(t){Object.keys(JSON.parse(r)[t]).forEach((function(c){let o=null,n=JSON.parse(r)[t][c].id,s=JSON.parse(r)[t][c].realPrice*localStorage.getItem(n);a+=JSON.parse(r)[t][c].realPrice*localStorage.getItem(n),o=1==JSON.parse(r)[t][c].imageStatus?cdn+"assets/img/small/"+JSON.parse(r)[t][c].imageUrl:cdn2+"assets/img/small/"+JSON.parse(r)[t][c].imageUrl,"table"==e?(l+='\n                    <tr style="height:100px;" id="product_'+n+'">\n                        <td>\n                            <a href="'+JSON.parse(r)[t][c].productUrl+'">\n                                <img class="img-fluid"\n                                    src="'+o+'"\n                                    alt="'+JSON.parse(r)[t][c].name+'">\n                            </a>\n                        </td>\n                        <td><a href="'+JSON.parse(r)[t][c].productUrl+'">'+JSON.parse(r)[t][c].name+'</a></td>\n                        <td><input onchange="count('+n+')" id="number_'+n+'" type="number" min="1" value="'+localStorage.getItem(n)+'" class="form-control"></td>\n                        <td>'+JSON.parse(r)[t][c].realPrice+' Ft/Db</td>\n                        <td id="partPrice_'+n+'">'+s+' Ft</td>\n                        <td><a href="#" onclick="cartItemDelete('+n+')"><i class="fas fa-trash-alt"></i></a></td>\n                    </tr>\n                ',$("#tbody").html(l),$("#totalPrice").html(a+" Ft")):"count"==e?($("#partPrice_"+n).html(s+" Ft"),$("#totalPrice").html(a+" Ft")):"remove"==e&&$("#totalPrice").html(a+" Ft")}))}))}function ajax(t){$.ajax({url:"https://"+window.location.hostname+"/kosar",type:"POST",async:!0,data:{status:1,keys:keys},success:function(e){products=e,cartGenerate(products,t)}})}function cartItemDelete(t){if(0!=localStorage.getItem("cartValue")){let e=localStorage.getItem("cartValue");keys=[],products=null,localStorage.removeItem(t),localStorage.setItem("cartValue",--e),keyCount(),ajax("remove"),$("#product_"+t).remove(),$(".cart").text(e),$("#getCart").text(e),0==e&&($("#tbody").remove(),$("#totalPrice").html("0 Ft"))}}function count(t){let e=$("#number_"+t).val();localStorage.setItem(t,e),cartGenerate(products,"count"),setExpiry(2)}null!=localStorage.getItem("cartValue")&&$("#getCart").text(localStorage.getItem("cartValue")),keyCount(),ajax("table");
